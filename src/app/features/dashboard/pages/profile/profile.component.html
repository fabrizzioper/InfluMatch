<div class="profile-container" *ngIf="!loading && user">
  <div class="profile-header">
    <h1>Mi Perfil</h1>
    <button
      mat-raised-button
      color="primary"
      routerLink="/dashboard/profile/edit"
    >
      Editar Perfil
    </button>
  </div>

  <div class="profile-content">
    <div class="profile-main">
      <div class="profile-avatar">
        <img [src]="user.avatar_url || getDefaultAvatar()" [alt]="user.name" />
      </div>
      <div class="profile-info">
        <h2>{{ user.display_name || user.name }}</h2>
        <p class="user-type">
          {{ user.user_type === "influencer" ? "Influencer" : "Marca" }}
        </p>
        <p *ngIf="user.bio">{{ user.bio }}</p>
        <p *ngIf="user.location" class="location">
          <mat-icon>location_on</mat-icon> {{ user.location }}
        </p>
        <p *ngIf="user.email" class="email">
          <mat-icon>email</mat-icon> {{ user.email }}
        </p>
      </div>
    </div>

    <!-- Información específica para influencers -->
    <mat-card *ngIf="isInfluencer(user)" class="info-card">
      <mat-card-header>
        <mat-card-title>Información del Influencer</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-row" *ngIf="user.niche">
          <span class="info-label">Nicho:</span>
          <span class="info-value">{{ user.niche }}</span>
        </div>

        <div class="info-row" *ngIf="user.followers">
          <span class="info-label">Seguidores:</span>
          <div class="followers-info">
            <div class="follower-count" *ngIf="user.followers.instagram">
              <mat-icon>photo_camera</mat-icon>
              <span>{{ formatFollowers(user.followers.instagram) }}</span>
            </div>
            <div class="follower-count" *ngIf="user.followers.tiktok">
              <mat-icon>music_note</mat-icon>
              <span>{{ formatFollowers(user.followers.tiktok) }}</span>
            </div>
            <div class="follower-count" *ngIf="user.followers.youtube">
              <mat-icon>smart_display</mat-icon>
              <span>{{ formatFollowers(user.followers.youtube) }}</span>
            </div>
          </div>
        </div>

        <div class="info-row" *ngIf="user.rate_per_post">
          <span class="info-label">Tarifa por publicación:</span>
          <span class="info-value">${{ user.rate_per_post }} USD</span>
        </div>

        <div class="info-row" *ngIf="user.engagement_rate">
          <span class="info-label">Engagement:</span>
          <span class="info-value">{{ user.engagement_rate }}%</span>
        </div>

        <div class="info-row" *ngIf="user.main_audience">
          <span class="info-label">Audiencia principal:</span>
          <span class="info-value">{{ user.main_audience }}</span>
        </div>

        <div class="info-row" *ngIf="user.languages">
          <span class="info-label">Idiomas:</span>
          <span class="info-value">{{ user.languages }}</span>
        </div>

        <div class="info-row" *ngIf="user.preferred_categories">
          <span class="info-label">Categorías preferidas:</span>
          <span class="info-value">{{ user.preferred_categories }}</span>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Información específica para marcas -->
    <mat-card *ngIf="isBrand(user)" class="info-card">
      <mat-card-header>
        <mat-card-title>Información de la Marca</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-row" *ngIf="user.sector">
          <span class="info-label">Sector:</span>
          <span class="info-value">{{ user.sector }}</span>
        </div>

        <div class="info-row" *ngIf="user.budget_range">
          <span class="info-label">Presupuesto:</span>
          <span class="info-value">{{ user.budget_range }}</span>
        </div>

        <div class="info-row" *ngIf="user.objectives">
          <span class="info-label">Objetivos:</span>
          <span class="info-value">{{ user.objectives }}</span>
        </div>

        <div class="info-row" *ngIf="user.campaign_duration">
          <span class="info-label">Duración de campaña:</span>
          <span class="info-value">{{ user.campaign_duration }}</span>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Contacto para marcas -->
    <mat-card *ngIf="isBrand(user)" class="info-card">
      <mat-card-header>
        <mat-card-title>Contacto</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="info-row" *ngIf="user.contact_name">
          <span class="info-label">Nombre de contacto:</span>
          <span class="info-value">{{ user.contact_name }}</span>
        </div>

        <div class="info-row" *ngIf="user.contact_position">
          <span class="info-label">Cargo:</span>
          <span class="info-value">{{ user.contact_position }}</span>
        </div>

        <div class="info-row" *ngIf="user.email">
          <span class="info-label">Email:</span>
          <span class="info-value">{{ user.email }}</span>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Redes sociales -->
    <mat-card *ngIf="user.social_links" class="info-card">
      <mat-card-header>
        <mat-card-title>Redes Sociales</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <div class="social-links">
          <a
            *ngIf="user.social_links.instagram"
            href="https://instagram.com/{{ user.social_links.instagram }}"
            target="_blank"
            class="social-link"
          >
            <mat-icon>photo_camera</mat-icon>
            <span>Instagram</span>
          </a>
          <a
            *ngIf="user.social_links.facebook"
            href="https://facebook.com/{{ user.social_links.facebook }}"
            target="_blank"
            class="social-link"
          >
            <mat-icon>facebook</mat-icon>
            <span>Facebook</span>
          </a>
          <a
            *ngIf="user.social_links.tiktok"
            href="https://tiktok.com/@{{ user.social_links.tiktok }}"
            target="_blank"
            class="social-link"
          >
            <mat-icon>music_note</mat-icon>
            <span>TikTok</span>
          </a>
          <a
            *ngIf="user.social_links.youtube"
            href="https://youtube.com/{{ user.social_links.youtube }}"
            target="_blank"
            class="social-link"
          >
            <mat-icon>smart_display</mat-icon>
            <span>YouTube</span>
          </a>
          <a
            *ngIf="user.social_links.twitter"
            href="https://twitter.com/{{ user.social_links.twitter }}"
            target="_blank"
            class="social-link"
          >
            <mat-icon>chat</mat-icon>
            <span>Twitter</span>
          </a>
        </div>
      </mat-card-content>
    </mat-card>

    <!-- Información adicional -->
    <mat-card *ngIf="isBrand(user) && user.additional_info" class="info-card">
      <mat-card-header>
        <mat-card-title>Información Adicional</mat-card-title>
      </mat-card-header>
      <mat-card-content>
        <p>{{ user.additional_info }}</p>
      </mat-card-content>
    </mat-card>
  </div>
</div>

<!-- Loading state -->
<div class="loading-container" *ngIf="loading">
  <mat-spinner diameter="50"></mat-spinner>
  <p>Cargando perfil...</p>
</div>

<!-- Error state -->
<div class="error-container" *ngIf="error">
  <mat-icon color="warn">error_outline</mat-icon>
  <h2>No se pudo cargar el perfil</h2>
  <p>
    Ha ocurrido un error al cargar la información. Por favor, intenta de nuevo
    más tarde.
  </p>
</div>
